{% extends 'components/layout.swig.html' %}

{% block css %}
  {% include 'components/profile/commoncss.swig.html' %}
  <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet"/>
  <link rel='stylesheet' href='{{ assetPrefix }}/plugins/bootstrap-markdown/css/bootstrap-markdown.min.css'>
  <style>
    #tagsInput {
      -webkit-appearance: none;
      -webkit-rtl-ordering: logical;
      align-items: flex-start;
      background-attachment: scroll;
      background-clip: border-box;
      background-color: rgb(255, 255, 255);
      background-image: none;
      background-origin: padding-box;
      background-size: auto;
      border-bottom-color: rgb(153, 153, 153);
      border-bottom-left-radius: 0px;
      border-bottom-right-radius: 0px;
      border-bottom-style: solid;
      border-bottom-width: 1px;
      border-image-outset: 0px;
      border-image-repeat: stretch;
      border-image-slice: 100%;
      border-image-source: none;
      border-image-width: 1;
      border-left-color: rgb(153, 153, 153);
      border-left-style: solid;
      border-left-width: 1px;
      border-right-color: rgb(153, 153, 153);
      border-right-style: solid;
      border-right-width: 1px;
      border-top-color: rgb(153, 153, 153);
      border-top-left-radius: 0px;
      border-top-right-radius: 0px;
      border-top-style: solid;
      border-top-width: 1px;
      box-sizing: border-box;
      clip: rect(0px 0px 0px 0px);
      color: rgb(64, 64, 64);
      cursor: default;
      display: block;
      font-family: 'Open Sans', Helvetica, Arial, sans-serif;
      font-size: 14px;
      font-stretch: normal;
      font-style: normal;
      font-variant: normal;
      font-weight: normal;
      height: 33px;
      letter-spacing: normal;
      line-height: 23px;
      margin-bottom: -1px;
      margin-left: -1px;
      margin-right: -1px;
      margin-top: -1px;
      outline-color: rgb(64, 64, 64);
      outline-style: none;
      outline-width: 0px;
      overflow-x: hidden;
      overflow-y: hidden;
      padding-bottom: 6px;
      padding-left: 10px;
      padding-right: 10px;
      padding-top: 6px;
      position: absolute;
      text-align: start;
      text-indent: 0px;
      text-rendering: auto;
      text-shadow: none;
      text-transform: none;
      transition-delay: 0s;
      transition-duration: 0.3s;
      transition-property: border-color;
      transition-timing-function: ease;
      white-space: nowrap;
      width: 707.5px;
      word-spacing: 0px;
      writing-mode: lr-tb;
      -webkit-writing-mode: horizontal-tb;
    }
  </style>
{% endblock %}

{% block content %}
  <!--=== Profile ===-->
  <div class="container content profile">
    <div class="row">
      {% include 'components/flashhandler.swig.html' %}
      {% include 'components/profile/sidebar.swig.html' %}
      <!-- Profile Content -->
      <div class="col-md-9">
        <div class="profile-body margin-bottom-20">
          <div class="tab-v1">
            <ul class="nav nav-justified nav-tabs">
              <li class="active"><a data-toggle="tab" href="#generalContent">General</a></li>
            </ul>
            <div class="tab-content">
              {# General addon stuff #}
              <div id="generalContent" class="profile-edit tab-pane fade in active">
                <h2 class="heading-md">General Addon Information</h2>

                <p>Here you need to specify your addon's general information. All of this information is
                  required as we need it to review your addon. Once your addon has been accepted, you may customize its
                  description and media.</p>
                <br>

                <form class="sky-form" id="generalForm" enctype="multipart/form-data" method="POST"
                      action="/profile/addons/{{ addon.id }}/edit">
                  <input type="hidden" name="_csrf" value="{{ _csrf }}"/>
                  <fieldset>
                    <section>
                      <label class="label">Addon Name</label>
                      <label class="input">
                        <i class="icon-prepend icon icon-font"></i>
                        <input type="text" value="{{ addon.name }}" name="name" id="nameInput" required>
                        <b class="tooltip tooltip-bottom-left">This is the name of your addon. Choose something short
                          and descriptive.</b>
                      </label>
                    </section>

                    <section>
                      <label class="label">Desired Price</label>
                      <label class="input">
                        <i class="icon-prepend icon icon-usd"></i>
                        <input type="number" step="any" value="{{ addon.price / 100 }}" name="price" id="priceInput"
                               required>
                        <b class="tooltip tooltip-bottom-left">This is how much you would like your addon to sell for.
                          If you want this to be a free addon, enter 0.</b>
                      </label>
                    </section>

                    <section>
                      <label class="label">Gamemode</label>
                      <label class="select">
                        <select name="gamemode" id="gamemodeInput" required>
                          <option value="0">Sandbox Based</option>
                          <option value="1">Dark RP</option>
                          <option value="2">TTT</option>
                          <option value="3">Murder</option>
                          <option value="4">Other</option>
                        </select>
                        <i></i>
                      </label>
                    </section>

                    <section>
                      <label class="label">Type</label>
                      <label class="select">
                        <select name="type" id="typeInput" required>
                          <option value="0">Weapon</option>
                          <option value="1">Chatbox</option>
                          <option value="2">Utility</option>
                          <option value="3">Other</option>
                        </select>
                        <i></i>
                      </label>
                    </section>

                    <section>
                      <label class="label">Tags (Choose popular tags or add your own)</label>
                      <select name="rawTags" id="tagsInput" multiple="multiple">
                        {% for tag in popularTags %}
                          <option value="{{ tag.name }}">{{ tag.name }}</option>
                        {% endfor %}
                      </select>
                    </section>
                  </fieldset>

                  <fieldset>
                    <section>
                      <label class="checkbox"><input type="checkbox" name="outsideServers" id="outsideServersInput"
                                                     {% if addon.outsideServers %}checked{% endif %}><i></i>Does your
                        addon make calls to outside servers?</label>
                      <label class="checkbox"><input type="checkbox" name="containsDrm" id="containsDrmInput"
                                                     {% if addon.containsDrm %}checked{% endif %}><i></i>Does your addon
                        contain DRM or leak protection?</label>
                    </section>
                  </fieldset>

                  <fieldset>
                    <section>
                      <label class="label">Zip File (Containing your addon)</label>
                      <label for="file" class="input input-file">
                        <div class="button"><input type="file" id="zipFileInout" name="zipFile" accept="application/zip,application/x-zip,application/x-zip-compressed">Browse</div><input type="text" readonly="">
                      </label>
                    </section>
                  </fieldset>
                  <fieldset>
                    <section>
                      <label class="label">Card Image (Aspect ratio 2:3, preferred size is 400 by 600)</label>
                      <label for="file" class="input input-file">
                        <div class="button"><input type="file" id="cardImageInput" name="cardImage" accept="image/*">Browse</div><input type="text" readonly="">
                      </label>
                    </section>
                    <section>
                      <label class="label">Gallery Images (Aspect ratio 1:1, preferred size is 600 by 600)</label>
                      <label for="file" class="input input-file">
                        <div class="button"><input type="file" id="galleryImagesInput" name="galleryImages" accept="image/*" multiple>Browse</div><input type="text" readonly="">
                      </label>
                    </section>
                    <section>
                      <label class="label">Banner Image (Optional, only 1920 by 500 will be accepted)</label>
                      <label for="file" class="input input-file">
                        <div class="button"><input type="file" id="bannerImageInput" name="bannerImage" accept="image/*">Browse</div><input type="text" readonly="">
                      </label>
                    </section>
                  </fieldset>

                  <fieldset>
                    <section>
                      <label class="label">Short Description</label>
                      <label class="input">
                        <i class="icon-prepend icon icon-comment"></i>
                        <input type="text" value="{{ addon.shortDescription }}" name="shortDescription" required>
                        <b class="tooltip tooltip-bottom-left">This short blurb will be displayed near the top of your
                          addon's store page. Aim for two sentences.</b>
                      </label>
                    </section>

                    <section>
                      <label class="label">Long Description</label>
                      <label class="textarea">
                        <textarea id="descriptionEditor" rows="10" name="description"></textarea>
                      </label>
                    </section>

                    <section>
                      <label class="label">Youtube Embeddable Link</label>
                      <label class="input">
                        <i class="icon-prepend icon icon-youtube"></i>
                        <input type="text" value="{{ addon.youtubeLink }}" name="youtubeLink">
                        <b class="tooltip tooltip-bottom-left">This youtube video will be displayed on your addon's
                          store page, near the bottom. Please use the embeddable link.</b>
                      </label>
                    </section>
                  </fieldset>

                  <fieldset>
                    <section>
                      <label class="label">Reason for Update</label>
                      <label class="input">
                        <i class="icon-prepend icon icon-question"></i>
                        <input type="text" value="" name="reasonForUpdate" id="reasonInput" required>
                        <b class="tooltip tooltip-bottom-left">What is the reason for updating your addon?</b>
                      </label>
                    </section>
                  </fieldset>

                  <footer>
                    <button id='submitButton' class="button">Submit</button>
                  </footer>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- End Profile Content -->
    </div>
  </div><!--/container-->
  <!--=== End Profile ===-->
{% endblock %}

{% block scripts %}
  <script src="{{ assetPrefix }}/plugins/bootstrap-markdown/js/markdown.js"></script>
  <script src="{{ assetPrefix }}/plugins/bootstrap-markdown/js/to-markdown.js"></script>
  <script src="{{ assetPrefix }}/plugins/jquery-hotkeys/jquery.hotkeys.js"></script>
  <script src="{{ assetPrefix }}/plugins/bootstrap-markdown/js/bootstrap-markdown.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
  <script async>
    // Attach the addon to the window so it can be accessed from client-side Javascript
    window.addon = {{ addon|json|safe }};

    // Setup the description editor
    var $descriptionEditor = $("#descriptionEditor");
    $descriptionEditor.val(window.addon.description);
    $descriptionEditor.markdown({autofocus: false, savable: false, fullscreen: false, iconlibrary: 'mm'})

    $("#tagsInput").select2({
      tags: true,
      tokenSeparators: [',', ' ']
    });

    $("input:file").on('change', function(e) {
      $(this).parent().next().val($(this).val());
    })
  </script>
  <script async src="{{ assetPrefix }}/js/pages/profile/editAddon.js"></script>
{% endblock %}
